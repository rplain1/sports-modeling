
```{python}
import numpy as np
import pandas as pd
import pymc as pm
import xarray as xr
import arviz as az
from arviz.stats.stats import hdi
from scipy import stats as stats
from matplotlib import pyplot as plt
import duckdb
import polars as pl
from plotnine import ggplot, aes, geom_density

rng = 527
```

```{python}
df = pl.scan_parquet(
    "https://github.com/sportsdataverse/sportsdataverse-data/releases/download/espn_wnba_team_boxscores/team_box_2024.parquet",
    glob=True
).filter(
    (~pl.col('team_name').str.contains('Team')) &
    (pl.col('season_type') == 2) # regular season
).collect()

df['team_name'].n_unique()
```


```{python}
df_long = df[['game_id', 'game_date', 'team_home_away', 'team_id', 'team_name', 'team_score', 'opponent_team_id', 'opponent_team_name',
''
]]

df_long.join(
    df_long.select(['game_id', 'game_date'])
)

```
